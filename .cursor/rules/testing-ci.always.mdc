---
name: Testing and CI - Always Apply
description:
globs:
alwaysApply: true
---

# Testing and CI - Always Apply

## ğŸ§ª **MANDATORY: Use Built-in CI System**

### **ALWAYS Prefer Automation Over Manual Testing**
```bash
# âœ… CORRECT: Use automated testing
tools/run_ci.ps1 -Phase Audit -FailOnError -MinRows 1

# âŒ WRONG: Manual testing only
# Manual testing is error-prone and inconsistent
```

### **CI System Benefits**
- **Consistent results** across different environments
- **Comprehensive logging** with before/after states
- **Screenshot capture** for visual verification
- **Regression testing** after implementing fixes
- **Eliminates human error** in testing

## ğŸ“Š **MANDATORY: Log Analysis After Every Change**

### **Immediate Log Check Required**
After ANY fix or change:
1. **Check generated log files** immediately
2. **Compare before/after log states** to verify the fix worked
3. **Look for error patterns** that might indicate new issues
4. **Document the log analysis** in responses
5. **Logs contain the truth** about what's happening

### **Log Analysis Commands**
```bash
# Check CI logs
Get-Content "Reports/ci_*.log" | Select-String "ERROR\|WARNING\|FAILED"

# Compare before/after states
Get-ChildItem "Reports/" | Sort-Object LastWriteTime -Descending | Select-Object -First 5
```

## ğŸ” **Testing Validation Steps**

### **Before Testing**
- âœ… **All plugin DLLs rebuilt** together
- âœ… **Build timestamps match** across modules
- âœ… **Project files regenerated** if needed

### **During Testing**
- âœ… **Use CI system** when possible
- âœ… **Capture screenshots** for verification
- âœ… **Monitor log output** in real-time

### **After Testing**
- âœ… **Check generated logs** immediately
- âœ… **Analyze error patterns** if any
- âœ… **Update development log** with results
- âœ… **Verify fix actually worked** through logs

## âš ï¸ **Common Testing Mistakes**

### **Ghost Code Trap**
```cpp
// âŒ SYMPTOM: Old code still runs after "fixes"
// âŒ CAUSE: Partial rebuilds, mismatched DLL timestamps
// âœ… SOLUTION: Rebuild ALL plugin DLLs together
```

### **Log Ignorance**
```cpp
// âŒ SYMPTOM: "Fix didn't work" without log analysis
// âŒ CAUSE: Not checking logs after changes
// âœ… SOLUTION: ALWAYS check logs immediately after changes
```

### **Manual Testing Only**
```cpp
// âŒ SYMPTOM: Inconsistent test results
// âŒ CAUSE: Relying only on manual testing
// âœ… SOLUTION: Use CI system for consistent, reproducible results
```

## ğŸ¯ **Success Metrics**

- âœ… **CI system used** for testing when possible
- âœ… **Logs analyzed** after every change
- âœ… **Before/after states** compared and documented
- âœ… **Error patterns** identified and addressed
- âœ… **Development log updated** with test results
- âœ… **Fix effectiveness** verified through log analysis

## ğŸ›¡ï¸ **Behavior Preservation Verification - CRITICAL**

### **Validation Checklist**
- âœ… **Clean rebuild** of all plugin modules without warnings from UHT or UBT
- âœ… **Feature reproduces** the same behavior as before the fix
- âœ… **No features disabled**, hidden, or removed
- âœ… **CI or scripted test run** passes and logs are attached
- âœ… **Packaging still succeeds** with the plugin enabled

### **Behavior Verification Steps**
1. **Exercise affected features** end-to-end to confirm behavior is unchanged
2. **Compare outputs** before and after the fix
3. **Verify UI elements** still function as expected
4. **Check performance** characteristics remain similar
5. **Validate data integrity** and consistency

### **Regression Testing Requirements**
- **Run comprehensive tests** that cover the affected functionality
- **Test edge cases** and error conditions
- **Verify integration points** with other systems
- **Check backward compatibility** if APIs were modified

### **Evidence Collection**
- **Screenshots** of before/after states
- **Log files** showing successful execution
- **Performance metrics** if applicable
- **Test results** from CI system
- **User acceptance** verification if UI was modified

description: Testing and CI rules that enforce automated testing, comprehensive log analysis, and behavior preservation verification for the MagicOptimizer UE5 plugin project.
globs: ["**/*.cpp", "**/*.h", "**/*.py", "**/*.ps1", "**/*.md"]
alwaysApply: true
---
